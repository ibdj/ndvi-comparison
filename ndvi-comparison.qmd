---
title: "Comparison of NDVI plot sampling and Sentinel satelitte imagery"
author: "Ida Bomholt Dyrholm Jacobsen"
date: last-modified
date-format: "YYYY-MM-DD HH:mm"
format:
  pdf:
    fig-pos: "H"
    fig-width: 9
    fig-height: 5
    documentclass: scrartcl
    toc: true
    lof: true
    number-sections: true
    colorlinks: true
editor: visual
execute: 
   echo: false
#  warning: false
#  message: false
---

# Introduction

The following report compares the measures of NDVI measured with a RapidScan handheld and satelite derived NDVI from Sentinel 2, as well as assessing the importance of accurate georeferencing of plot, when doing such comparisons.

## BioBasis NDVI sampling

NDVI have been measured as part of the BioBasis Nuuk sampling protocal since 2007. Measurements of NDVI have been done in c-flux plots, phenology plots and along the NERO line. NDVI measurements in c-flux plots have been done with a SpectroSence2 (REF), in phenology plots and along the NERO line it was measured with a CropCircle (REF) from 2007 - 2017). From 2018 NDVI has been measured with a RapidScan from Holland Scientific.

```{r}
#| label: loading-p
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
```

```{r}
#| label: importing-biobasis-data

biobasis_ndvi <- readRDS("biobasis_ndvi.rds") |> 
  mutate(plot_id = paste0(Species,Plot))

ndvi_biobasis_dates <- biobasis_ndvi |> 
  distinct(Date)
```

There are measurements from `r min(biobasis_ndvi$Date)` and `r max(biobasis_ndvi$Date)`, and from a total of `r length(unique(biobasis_ndvi$Date))` individual days of measurements from the `r length(unique(biobasis_ndvi$plot_id))` plots.

NDVI is measured as a mean (calculated by the RapidScan) for each subsection of the phenology plot. For the comparison with Sentinel a further mean is calculate pr plot.

```{r}
#| label: data-prep-comparison

biobasis_ndvi_meanprplot <- biobasis_ndvi |> 
  group_by(Date, plot_id) |> 
  summarise(mean = mean(NDVI), 
            year = mean(year(Date)))


```

## Sentinel 'sampling'

Sentinel derived NDVI values were extracted by Google Earth Engine and process in R. To ensure high temporal correspondence between the Sentinel derived NDVI and the plot measured NDVI only sentinel images from with in +/- 2 days from of a plot measurement were used.

ADJUST THE GEE CODE TO ONLY TAKE THE ONE IMAGE THAT IS CLOSEST TO THE NDVI DATE!

# Comparison

You can add options to executable code like this

```{r}
#| echo: false

```

The `echo: false` option disables the printing of code (only output is displayed).
